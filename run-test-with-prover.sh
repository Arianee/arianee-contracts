#!/bin/bash

# We init the Prover here so its shared between all tests, note that all tests using this Prover must use the same context as defined here (in the `initArgs` variable)
# You can also directly init the Prover from a test `setUp()` with `proverFfi("init", vm.toString(abi.encode(...)));

# Variables: signerPk, protocolVersion, chainId, aria, creditHistory, arianeeEvent, identity, smartAsset, store, lost, whitelist, arianeeMessage, smartAssetUpdate, issuerProxy
# Types: ["uint256","string","uint256","address","address","address","address","address","address","address","address","address","address","address"]
# Values: [123, "1.0", 1337, address(1), address(2), address(3), address(4), address(5), address(6), address(7), address(8), address(9), address(10), address(11)]
initArgs="0x000000000000000000000000000000000000000000000000000000000000007b00000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000539000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000009000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000b0000000000000000000000000000000000000000000000000000000000000003312e300000000000000000000000000000000000000000000000000000000000"
npm run --silent prover init "$initArgs" -- --no-stdout-write

forge test --force --match-path "./test/**/*.t.p.sol" "$@"
npm run --silent prover stop
